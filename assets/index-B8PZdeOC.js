import{a as L,_ as y}from"./index-q8uFWT42.js";import{r as o}from"./index-l2PZgWEW.js";import{f as m,$ as O,c as h,g as z}from"./index-CeZp-NtI.js";import{R as A}from"./index-CaNG7YX3.js";function K(r,e=globalThis==null?void 0:globalThis.document){const t=m(r);o.useEffect(()=>{const s=n=>{n.key==="Escape"&&t(n)};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)},[t,e])}const p="dismissableLayer.update",N="dismissableLayer.pointerDownOutside",H="dismissableLayer.focusOutside";let x;const R=o.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),M=o.forwardRef((r,e)=>{var t;const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:b,onInteractOutside:l,onDismiss:u,...v}=r,c=o.useContext(R),[d,I]=o.useState(null),f=(t=d==null?void 0:d.ownerDocument)!==null&&t!==void 0?t:globalThis==null?void 0:globalThis.document,[,W]=o.useState({}),_=L(e,i=>I(i)),D=Array.from(c.layers),[B]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),k=D.indexOf(B),P=d?D.indexOf(d):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,g=P>=k,U=j(i=>{const $=i.target,w=[...c.branches].some(E=>E.contains($));!g||w||(a==null||a(i),l==null||l(i),i.defaultPrevented||u==null||u())},f),T=q(i=>{const $=i.target;[...c.branches].some(E=>E.contains($))||(b==null||b(i),l==null||l(i),i.defaultPrevented||u==null||u())},f);return K(i=>{P===c.layers.size-1&&(n==null||n(i),!i.defaultPrevented&&u&&(i.preventDefault(),u()))},f),o.useEffect(()=>{if(d)return s&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(x=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),C(),()=>{s&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=x)}},[d,f,s,c]),o.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),C())},[d,c]),o.useEffect(()=>{const i=()=>W({});return document.addEventListener(p,i),()=>document.removeEventListener(p,i)},[]),o.createElement(O.div,y({},v,{ref:_,style:{pointerEvents:S?g?"auto":"none":void 0,...r.style},onFocusCapture:h(r.onFocusCapture,T.onFocusCapture),onBlurCapture:h(r.onBlurCapture,T.onBlurCapture),onPointerDownCapture:h(r.onPointerDownCapture,U.onPointerDownCapture)}))}),X=o.forwardRef((r,e)=>{const t=o.useContext(R),s=o.useRef(null),n=L(e,s);return o.useEffect(()=>{const a=s.current;if(a)return t.branches.add(a),()=>{t.branches.delete(a)}},[t.branches]),o.createElement(O.div,y({},r,{ref:n}))});function j(r,e=globalThis==null?void 0:globalThis.document){const t=m(r),s=o.useRef(!1),n=o.useRef(()=>{});return o.useEffect(()=>{const a=l=>{if(l.target&&!s.current){let v=function(){F(N,t,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=v,e.addEventListener("click",n.current,{once:!0})):v()}else e.removeEventListener("click",n.current);s.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",a),e.removeEventListener("click",n.current)}},[e,t]),{onPointerDownCapture:()=>s.current=!0}}function q(r,e=globalThis==null?void 0:globalThis.document){const t=m(r),s=o.useRef(!1);return o.useEffect(()=>{const n=a=>{a.target&&!s.current&&F(H,t,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,t]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function C(){const r=new CustomEvent(p);document.dispatchEvent(r)}function F(r,e,t,{discrete:s}){const n=t.originalEvent.target,a=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&n.addEventListener(r,e,{once:!0}),s?z(n,a):n.dispatchEvent(a)}const Y=M,Z=X,ee=o.forwardRef((r,e)=>{var t;const{container:s=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...n}=r;return s?A.createPortal(o.createElement(O.div,y({},n,{ref:e})),s):null});export{ee as $,M as a,Z as b,Y as c};
