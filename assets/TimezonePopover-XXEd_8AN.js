import{j as t}from"./jsx-runtime-DR9Q75dM.js";import{r as s}from"./index-DRjF_FHU.js";import{D as v,a as D,b as O,$}from"./DropdownMenu-XER5NlNu.js";import{c as j}from"./cn-8RyR4BqC.js";import{F as A}from"./chevron-right-D4FvqfWr.js";import{F as E}from"./check-C0C6JGvp.js";import{F as I}from"./clock-DRhx3Wks.js";import{u as L,g as B,S as V}from"./useClickOutside-Bx7J1K8K.js";import{T as p}from"./Text-C8HBwI4b.js";import{I as w}from"./Icon-CTnhpE1d.js";import{B as _}from"./Button-C-jt4Opy.js";import{D as U}from"./Divider-CIm89-oy.js";const q=(a,c,n)=>{if(!c)return!0;const i=c.toLowerCase();return n.some(r=>{const f=a[r];return typeof f=="string"?f.toLowerCase().includes(i):!1})},M=s.forwardRef(({value:a,onChange:c,contentProps:n,className:i,...r})=>{const[f,g]=s.useState(!1),[x,b]=s.useState(a),[l,S]=s.useState(new Map),[m,T]=s.useState(""),N=s.useRef(null),{basicOptions:u,fetchTimezoneOptions:z}=L(),C=e=>{b(e),c&&c(e)},y=s.useCallback(e=>{if(!e)return t.jsx(p,{children:"Select timezone"});const o=u.includes(e)?e.name:e.zone,h=e.zone!=="UTC"?e.utc:"";return t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx(w,{icon:t.jsx(I,{})}),t.jsxs(p,{children:[o," ",h]})]})},[u]),R=s.useCallback((e,o)=>{const h=u.includes(e)?e.name:e.zone,F=e.zone!=="UTC"?e.utc.replace(/\(|\)/g,""):"";return t.jsxs("div",{className:j("relative flex gap-2 justify-between items-center p-2 pr-8 hover:bg-accent-weak group-hover:bg-accent-weak",{}),children:[t.jsx(p,{className:"text-text-default",children:h}),F&&t.jsx(p,{className:"text-text-weak",children:F}),o&&t.jsx(w,{icon:t.jsx(E,{}),className:"absolute right-2 text-text-accent"})]})},[u]),d=s.useMemo(()=>m?new Map(Array.from(l.entries()).filter(([e,o])=>q(o,m,["name","zone","utc"]))):l,[l,m]),k=s.useMemo(()=>Array.from(d.values()).some(e=>!u.includes(e)),[d,u]);return s.useEffect(()=>{a&&b(a)},[a]),s.useEffect(()=>{z().then(e=>{S(new Map(e.map(o=>[B(o),o])))})},[z]),s.useEffect(()=>{f||T("")},[f]),s.useEffect(()=>{var e;(e=N.current)==null||e.focus()},[N]),t.jsxs(v,{...r,open:f,onOpenChange:g,children:[t.jsx(D,{asChild:!0,children:t.jsx(_,{variant:"nude",theme:"neutral",iconPosition:"right",icon:t.jsx(w,{icon:t.jsx(A,{})}),className:j("px-2 justify-between hover:bg-accent-weak hover:text-text-accent",i),children:y(x?l.get(x):void 0)})}),t.jsxs(O,{side:"right",align:"start",...n,className:j("max-h-[350px] w-[320px] p-0 overflow-hidden flex flex-col text-text-default",n==null?void 0:n.className),onCloseAutoFocus:e=>e.preventDefault(),children:[t.jsx(G,{value:m,onChange:T,onEnterKeyDown:()=>{const e=Array.from(d.keys())[0];e&&(C(e),g(!1))}}),t.jsx("div",{className:"flex flex-col overflow-auto py-1 grow",children:Array.from(d.entries()).map(([e,o])=>t.jsxs(s.Fragment,{children:[t.jsx($,{className:"focus:outline-none",onClick:()=>C(e),children:R(o,x===e)}),o.isBrowserTimezone&&k&&t.jsx(U,{className:"m-1"})]},e))})]})]})}),G=({value:a,onChange:c,onEnterKeyDown:n})=>{const i=s.useRef(null);return s.useEffect(()=>{var r;(r=i.current)==null||r.focus()},[i]),t.jsx(V,{ref:i,autoFocus:!0,onClear:()=>c(""),value:a,onChange:r=>{c(r.target.value)},onKeyDown:r=>{r.code==="Enter"&&(n==null||n()),r.stopPropagation()},containerClassName:"border-0 rounded-b-none border-b border-border-default focus-within:border-border-default shadow-none"})};M.displayName="TimezoneDropdownMenu";M.__docgenInfo={description:"",methods:[],displayName:"TimezoneDropdownMenu"};export{M as T};
